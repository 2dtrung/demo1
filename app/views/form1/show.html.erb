<div id="docx">
  <div id="report1" class="WordSection1">
    <h1>BÁO CÁO THU NHẬP LÀM VIỆC TẠI</h1>
    <h1>DÀNH CHO NGƯỜI LÀM VIỆC TỰ DO</h1>
    <center>
      <p class="text-uppercase">Income statement for working at home</p>
      <p class="text-uppercase">(Type : Freelancer/self - employed)</p>
    </center>
    <p class="text-justify">Tên/Name: <%= current_user.name%></p>
    <p class="text-justify">Thời gian/Time: <%= "2020-12-24 - 2022-01-30"%></p>
    <p class="text-justify">Công Việc / Job: <%= "Online Selling"%></p>
    <table id="table1" class="table table-striped table-bordered" style="width:100%">
      <thead>
        <tr>
          <th>STT/No</th>
          <th>Ngày/Date</th>
          <th>Khách hàng/Customer</th>
          <th>Số tiền/Income</th>
          <th>Nội dung/Description</th>
          <th>Xác nhận/Signature</th>
        </tr>
      </thead>
      <%count=1%>
      <tbody>
        <% @form1.each do |form1| %>
          <tr>
            <td><%= count%></td>
            <td><%= form1.date %></td>
            <td><%= form1.customer %></td>
            <td><%= form1.income %></td>
            <td><%= form1.work_des %></td>
            <td><%= "" %></td>
            <%count+=1%>
          </tr>
        <% end %>
      </tbody>
      <%# <tfoot>
        <tr>
          <th>STT/No</th>
          <th>Ngày/Date</th>
          <th>Khách hàng/Customer</th>
          <th>Số tiền/Income</th>
          <th>Nội dung/Description</th>
          <th>Xác nhận/Signature</th>
        </tr>
      </tfoot> %>
    </table>
  </div>
</div>
<br>
<br>
<%= link_to 'Back', current_user ,class: "btn btn-lg btn-info"%>
<button type="button" class="btn btn-lg btn-info btn-lg" onclick="export2Word(window.docx)">Export to Word</button>
<%= link_to 'Export to Excel', user_form1_index_url(format: :csv) ,class: "btn btn-lg btn-info"%>
<button type="button" class="btn btn-lg btn-info btn-lg" id="downloadPDF">Export to PDF</button>
<%# <script type="text/javascript">
  $(document).ready(function() {
      $('#table1').DataTable();
  } );
</script> %>
<script type="text/javascript">
  $('#downloadPDF').click(function () {
      domtoimage.toPng(document.getElementById('report1'))
          .then(function (blob) {
              var pdf = new jsPDF('l', 'pt', [$('#report1').width(), $('#report1').height()]);
  
              pdf.addImage(blob, 'PNG', 0, 0, $('#report1').width(), $('#report1').height());
              pdf.save("Report for Freelncer.pdf");
  
              that.options.api.optionsChanged();
          });
  });
  
  function export2Word( element ) {
  
     var html, link, blob, url, css;
  
     css = (
       '<style>' +
       '@page WordSection1{size: 841.95pt 595.35pt;mso-page-orientation: landscape;}' +
       'div.WordSection1 {page: WordSection1;}' +
       '</style>'
     );
  
     html = element.innerHTML;
     blob = new Blob(['\ufeff', css + html], {
       type: 'application/msword'
     });
     url = URL.createObjectURL(blob);
     link = document.createElement('A');
     link.href = url;
     link.download = 'Report for Freelncer.docx';  // default name without extension
     document.body.appendChild(link);
     if (navigator.msSaveOrOpenBlob ) navigator.msSaveOrOpenBlob( blob, 'Document.doc'); // IE10-11
         else link.click();  // other browsers
     document.body.removeChild(link);
   };
</script>
